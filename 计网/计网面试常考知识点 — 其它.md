### 计网面试常考知识点 

### 一、**网络模型、协议**

#### 1、**简述网络七层参考模型，每一层的作用？**

| OSI七层模型 | 功能                                                         | 对应的网络协议                                               | TCP/IP四层概念模型 |
| ----------- | ------------------------------------------------------------ | ------------------------------------------------------------ | :----------------: |
| 应用层      | 文件传输，文件管理，电子邮件的信息处理                       | HTTP、TFTP, FTP, NFS, WAIS、SMTP                             |       应用层       |
| 表示层      | 确保一个系统的应用层发送的消息可以被另一个系统的应用层读取，编码转换，数据解析，管理数据的解密和加密。 | Telnet, Rlogin, SNMP, Gopher                                 |       应用层       |
| 会话层      | 负责在网络中的两节点建立，维持和终止通信。                   | SMTP, DNS                                                    |       应用层       |
| 传输层      | 定义一些传输数据的协议和端口。                               | TCP, UDP                                                     |       传输层       |
| 网络层      | 控制子网的运行，如逻辑编址，分组传输，路由选择               | IP, ICMP, ARP, RARP, AKP, UUCP                               |       网络层       |
| 数据链路层  | 主要是对物理层传输的比特流包装，检测保证数据传输的可靠性，将物理层接收的数据进行MAC（媒体访问控制）地址的封装和解封装 | FDDI, Ethernet, Arpanet, PDN, SLIP, PPP，STP。HDLC,SDLC,帧中继 |     数据链路层     |
| 物理层      | 定义物理设备的标准，主要对物理连接方式，电气特性，机械特性等制定统一标准。 | IEEE 802.1A, IEEE 802.2到IEEE 802.                           |     数据链路层     |

- 传输层数据被称为段、网络层数据被称为包、数据链路层数据被称为帧、物理层的数据称为比特流


#### 2、**OSI七层模型中表示层和会话层功能是什么？**

表示层：图像、视频编码解，数据加密。

会话层：建立会话，如session认证、断点续传。

#### 3、**网络层常见协议？可以说一下吗？**

| **协议** | **名称**             | **作用**                                                     |
| -------- | -------------------- | ------------------------------------------------------------ |
| IP       | 网际协议             | IP协议不但定义了数据传输时的基本单元和格式，还定义了数据报的递交方法和路由选择 |
| ICMP     | Internet控制报文协议 | ICMP就是一个“错误侦测与回报机制”，其目的就是让我们能够检测网络的连线状况﹐也能确保连线的准确性，是ping和traceroute的工作协议 |
| RIP      | 路由信息协议         | 使用“跳数”(即metric)来衡量到达目标地址的路由距离             |
| IGMP     | Internet组管理协议   | 用于实现组播、广播等通信                                     |

#### 4、**应用层常见协议知道多少？了解几个？**

| **协议** | **名称**                   | **默认端口**   | **底层协议**                                              |
| -------- | -------------------------- | -------------- | --------------------------------------------------------- |
| HTTP     | 超文本传输协议             | 80             | TCP                                                       |
| HTTPS    | 超文本传输安全协议         | 443            | TCP                                                       |
| Telnet   | 远程登录服务的标准协议     | 23             | TCP                                                       |
| FTP      | 文件传输协议               | 20传输和21连接 | TCP                                                       |
| TFTP     | 简单文件传输协议           | 69             | UDP                                                       |
| SMTP     | 简单邮件传输协议（发送用） | 25             | TCP                                                       |
| POP      | 邮局协议（接收用）         | 110            | TCP                                                       |
| DNS      | 域名解析服务               | 53             | 服务器间进行域传输的时候用TCP 客户端查询DNS服务器时用 UDP |

#### 5、**TCP对应的应用层协议**

- FTP：定义了文件传输协议，使用21端口. 


- Telnet：它是一种用于远程登陆的端口,23端口 
- SMTP：定义了简单邮件传送协议，服务器开放的是25号端口。 

#### 6、**UDP对应的应用层协议**

- DNS：用于域名解析服务，用的是53号端口 
- SNMP：简单网络管理协议，使用161号端口 
- TFTP(Trival File Transfer Protocal)：简单文件传输协议，69

#### 7、**数据链路层常见协议？可以说一下吗？**

| **协议** | **名称**         | **作用**                                                     |
| -------- | ---------------- | ------------------------------------------------------------ |
| ARP      | 地址解析协议     | 根据IP地址获取物理地址                                       |
| RARP     | 反向地址转换协议 | 根据物理地址获取IP地址                                       |
| PPP      | 点对点协议       | 主要是用来通过拨号或专线方式建立点对点连接发送数据，使其成为各种主机、网桥和路由器之间简单连接的一种共通的解决方案 |

#### 8、**Ping命令基于哪一层协议的原理是什么？**

- ping命令基于网络层的命令，是基于ICMP协议工作的。


#### 9、**什么是RARP？工作原理**

- RARP：反向地址转换协议，网络层协议，RARP和ARP工作方式相反。RARP使只知道自己硬件地址的主机能够知道其IP地址，RARP发出要反向解锁的物理地址并希望返回其IP地址，应答包括能够提供所需要信息的RARP服务器发出的IP地址。


- 原理：
  1. 网络上每台设备都会有一个独一无二的硬件地址，通常是设备厂商分配的MAC地址。主机从网卡读取MAC地址，然后在网络上发送一个RARP请求的广播数据包，请求RARP服务器回复该主机的IP地址。
  2. RARP服务器收到RARP请求数据包，为其分配IP地址，并将RARP回应发送给主机。
  3. 主机收到RARP回应后，就使用得到的IP地址进行通讯。

#### 10、**为何需要把TCP/IP协议栈分为5层或7层？**

- ARPANET的研制经验表明，对于复杂的计算机网络协议，其结构应该是层次式的。


- 分层的好处：

  - ① 各层之间是独立的
  - ② 灵活性好
  - ③ 结构上可以分隔开
  - ④ 易于实现和维护
  - ⑤ 能促进标准化工作

#### 11、为什么服务器会缓存这一项功能？如何实现的？

**原因：**

- **缓解服务器压力**
- *降低客户端获取资源的延迟**：缓存通常位于内存中，读取缓存的速度更快。并且缓存服务器在地理位置上也有可能比源服务器来得近，例如浏览器缓存。

**实现方法:**

1. **让代理服务器进行缓存**
2. **让客户端浏览器进行缓存**

#### 12、**端口有效范围是多少到多少？**

- 0-1023为知名端口号，如：HTTP是80，FTP是20（数据端口）、21（控制端口）


- UDP和TCP报头使用两个字节存放端口号，所以端口号的有效范围是0-65535.动态端口的范围是从1024 - 65535

### 二、**网络攻击**

#### 13、**DDos 攻击了解吗？**

- 客户端向服务端发送请求连接数据包，服务端向客户端发送确认数据包，客户端不向服务端发送确认数据包，服务器一直等待来自客户端的确认 没有彻底根治的办法，除非不使用TCP 


- DDos 预防

  - 1）限制同时打开SYN半链接的数目 
  - 2）缩短SYN半链接的Time out 时间 
  - 3）关闭不必要的服务

#### 14、**SYN攻击是什么？**

**服务端的资源分配是在二次握手时分配的，而客户端的资源是在完成三次握手时分配的，所以服务器容易受到SYN洪泛攻击。**

- SYN攻击就是Client在短时间内伪造大量不存在的IP地址，并向Server不断地发送SYN包，Server则回复确认包，并等待Client确认，由于源地址不存在，因此Server需要不断重发直至超时，这些伪造的SYN包将长时间占用未连接队列，导致正常的SYN请求因为队列满而被丢弃，从而引起网络拥塞甚至系统瘫痪。SYN 攻击是一种典型的 DoS/DDoS 攻击。
- 检测 SYN 攻击非常的方便，当你在服务器上看到大量的半连接状态时，特别是源IP地址是随机的，基本上可以断定这是一次SYN攻击。在 Linux/Unix 上可以使用系统自带的 netstats 命令来检测 SYN 攻击。

**常见的防御 SYN 攻击的方法有如下几种：**

- 缩短超时（SYN Timeout）时间
- 增加最大半连接数
- 过滤网关防护
- SYN cookies技术

#### 15、**XSS攻击是什么？（低频）**

- **跨站点脚本攻击，指攻击者通过篡改网页，嵌入恶意脚本程序，在用户浏览网页时，控制用户浏览器进行恶意操作的一种攻击方式。**如何防范XSS攻击 1）前端，服务端，同时需要字符串输入的长度限制。 2）前端，服务端，同时需要对HTML转义处理。将其中的”<”,”>”等特殊字符进行转义编码。 
- **防 XSS 的核心是必须对输入的数据做过滤处理。**

#### 16、**CSRF攻击？你知道吗？**

- **跨站点请求伪造，指攻击者通过跨站请求，以合法的用户的身份进行非法操作。**可以这么理解CSRF攻击：攻击者盗用你的身份，以你的名义向第三方网站发送恶意请求。CRSF能做的事情包括利用你的身份发邮件，发短信，进行交易转账，甚至盗取账号信息。

#### 17、**如何防范CSRF攻击**

1. **安全框架，例如Spring Security。** 
2. **token机制。**在HTTP请求中进行token验证，如果请求中没有token或者token内容不正确，则认为CSRF攻击而拒绝该请求。 
3. **验证码。**通常情况下，验证码能够很好的遏制CSRF攻击，但是很多情况下，出于用户体验考虑，验证码只能作为一种辅助手段，而不是最主要的解决方案。 
4. **referer识别。**在HTTP Header中有一个字段Referer，它记录了HTTP请求的来源地址。如果Referer是其他网站，就有可能是CSRF攻击，则拒绝该请求。但是，服务器并非都能取到Referer。很多用户出于隐私保护的考虑，限制了Referer的发送。在某些情况下，浏览器也不会发送Referer，例如HTTPS跳转到HTTP。 
   1. 验证请求来源地址；
   2. 关键操作添加验证码；
   3. 3在请求地址添加 token 并验证。

#### 18、**文件上传漏洞是如何发生的？你有经历过吗？**

- 文件上传漏洞，指的是用户上传一个可执行的脚本文件，并通过此脚本文件获得了执行服务端命令的能力。 许多第三方框架、服务，都曾经被爆出文件上传漏洞，比如很早之前的Struts2，以及富文本编辑器等等，可被攻击者上传恶意代码，有可能服务端就被人黑了。


#### 19、**如何防范文件上传漏洞**

- **文件上传的目录设置为不可执行。**
- **1）判断文件类型。**在判断文件类型的时候，可以结合使用MIME Type，后缀检查等方式。因为对于上传文件，不能简单地通过后缀名称来判断文件的类型，因为攻击者可以将可执行文件的后缀名称改为图片或其他后缀类型，诱导用户执行。
- **2）对上传的文件类型进行白名单校验，只允许上传可靠类型。**
- **3）上传的文件需要进行重新命名，使攻击者无法猜想上传文件的访问路径\****，将极大地增加攻击成本，同时向shell.php.rar.ara这种文件，因为重命名而无法成功实施攻击。
- **4）限制上传文件的大小。**
- **5）单独设置文件服务器的域名。**

#### 20、**简述CSRF攻击的思想以及解决方法**

CSRF全称叫做，跨站请求伪造。就是黑客可以伪造用户的身份去做一些操作，进而满足自身目的。要完成一次CSRF攻击，受害者必须依次完成两个步骤：

1. 登录受信任网站A，并在本地生成Cookie。 
2. 在不登出A的情况下，访问危险网站B。

此时，黑客就可以获取你的cookie达成不可告人的目的了。

CSRF 攻击是一种请求伪造的攻击方式，它利用的是服务器不能识别用户的类型从而盗取用户的信息来攻击。因此要防御该种攻击，因为从服务器端着手，增强服务器的识别能力，设计良好的防御机制。主要有以下几种方式：

1. 请求头中的Referer验证（不推荐）
   -  HTTP的头部有一个 Referer 信息的字段，它记录着该次HTTP请求的来源地址（即它从哪里来的）,既然CSRF攻击是伪造请求是从服务器发送过来的，那么我们就禁止跨域访问，在服务器端增加验证，过滤掉那些不是从本服务器发出的请求，这样可以在一定程度上避免CSRF攻击。 但是这也有缺点，比如如果是从搜索引擎所搜结果调整过来，请求也会被认为是跨域请求。
2. 请求令牌验证（token验证）
   - token验证是一种比较广泛使用的防止 CSRF攻击 的手段，当用户通过正常渠道访问服务器时，服务器会生成一个随机的字符串保存在session中，并作为令牌（token）返回给客户端，以隐藏的形式保存在客户端中，客户端每次请求都会带着这个token，服务器根据该token判断该请求是否合法

#### 21、**说说什么是 **SYN flood，如何防止这类攻击？

1. SYN Flood是当前最流行的DoS（**拒绝服务攻击**）与DDoS(**分布式拒绝服务攻击**)的方式之一，这是一种利用TCP协议缺陷，发送大量伪造的TCP连接请求，使被攻击方资源耗尽（CPU满负荷或内存不足)的攻击方式. 

2. 有以下三种方法预防或响应网络上的DDoS攻击：
   - **(1)从互联网服务提供商(ISP)购买服务。**
     - 许多互联网服务提供商(ISP)提供DDoS缓解服务，但是当企业网络受到攻击时，企业需要向互联网服务提供商(ISP)报告事件以开始缓解。这种策略称为“清洁管道”，在互联网服务提供商(ISP)收取服务费用时很受欢迎，但在缓解措施开始之前，通常会导致30到60分钟的网络延迟。
   - **(2)保留在内部并自己解决**
     - 企业可以使用入侵防御系统/防火墙技术和专用于防御DDoS攻击的专用硬件来实现内部预防和响应DDoS攻击。不幸的是，受影响的流量已经在网络上消耗了宝贵的带宽。这使得该方法最适合在托管设施中配备设备的企业，在这些企业中，流量是通过交叉连接到达互联网服务提供商(ISP)，从而保护流向企业其他部门的下游带宽。
   - **(3)使用内容分发网络(CDN)。**
     - 由于IT团队可以将基础设施置于内容分发网络(CDN)后面，因此这种方法可以最大程度地减少对企业网络基础设施的攻击。这些网络庞大而多样，如果组织订阅DNS和DDoS缓解措施，则它们可以保护电子商务站点以及企业本身。

### 三、补充

#### 22、**说说 MAC地址和IP地址分别有什么作用**

1. IP地址是IP协议提供的一种统一的地址格式，它为互联网上的每一个网络和每一台主机分配一个逻辑地址，以此来屏蔽物理地址的差异。而MAC地址，指的是物理地址，用来定义网络设备的位置。

2. **P地址的分配是根据网络的拓扑结构**，而不是根据谁制造了网络设置。若将高效的路由选择方案建立在设备制造商的基础上而不是网络所处的拓朴位置基础上，这种方案是不可行的。

3. 当存在一个附加层的地址寻址时，设备更易于移动和维修。例如，如果一个以太网卡坏了，可以被更换，而无须取得一个新的IP地址。如果一个IP主机从一个网络移到另一个网络，可以给它一个新的IP地址，而无须换一个新的网卡。

4. 无论是局域网，还是广域网中的计算机之间的通信，最终都表现为将数据包从某种形式的链路上的初始节点出发，从一个节点传递到另一个节点，最终传送到目的节点。数据包在这些节点之间的移动都是由ARP（Address Resolution Protocol：地址解析协议）负责将IP地址映射到MAC地址上来完成的。	

#### 23、**说说** **TCP** **如何加速一个大文件的传输**

1. 建连优化：TCP 在建立连接时，如果丢包，会进入重试，重试时间是 1s、2s、4s、8s 的指数递增间隔，缩短定时器可以让 TCP 在丢包环境建连时间更快，非常适用于高并发短连接的业务场景。

2. 平滑发包：在 RTT 内均匀发包，规避微分时间内的流量突发，尽量避免瞬间拥塞

3. 丢包预判：有些网络的丢包是有规律性的，例如每隔一段时间出现一次丢包，例如每次丢包都连续丢几个等，如果程序能自动发现这个规律（有些不明显），就可以针对性提前多发数据，减少重传时间、提高有效发包率。

4. RTO 探测：若始终收不到 ACK 报文，则需要触发 RTO 定时器。RTO 定时器一般都时间非常长，会浪费很多等待时间，而且一旦 RTO，CWND 就会骤降（标准 TCP），因此利用 Probe 提前与RTO 去试探，可以规避由于 ACK 报文丢失而导致的速度下降问题。

5. 带宽评估：通过单位时间内收到的 ACK 或 SACK 信息可以得知客户端有效接收速率，通过这个速率可以更合理的控制发包速度。

6. 带宽争抢：有些场景（例如合租）是大家互相挤占带宽的，假如你和室友各 1Mbps 的速度看电影，会把 2Mbps 出口占满，而如果一共有 3 个人看，则每人只能分到 1/3。若此时你的流量流量达到 2Mbps，而他俩还都是 1Mbps，则你至少仍可以分到 2/(2+1+1) * 2Mbps = 1Mbps 的 50%的带宽，甚至更多，代价就是服务器侧的出口流量加大，增加成本。（TCP 优化的本质就是用带宽换用户体验感）

#### 24、**服务器怎么判断客户端断开了连接**

1. 检测连接是否丢失的方法大致有两种：**keepalive**和**heart-beat**

2. （tcp内部机制）采用keepalive，它会先要求此连接一定时间没有活动（一般是几个小时），然后发出数据段，经过多次尝试后（每次尝试之间也有时间间隔），如果仍没有响应，则判断连接中断。可想而知，整个**周期需要很长**的时间。

3. （应用层实现）一个简单的heart-beat实现一般测试连接是否中断采用的时间间隔都比较短，可以**很快的决定连接是否中断**。并且，由于是在应用层实现，因为可以自行决定当判断连接中断后应该采取的行为，而keepalive在判断连接失败后只会将连接丢弃。

#### 25、**简述网关的作用是什么，同一网段的主机如何通信**

1. 网关即网络中的关卡，我们的互联网是一个一个的局域网、城域网、等连接起来的，在连接点上就是一个一个网络的关卡，即我们的网关，他是保证网络互连的，翻译和转换，使得不同的网络体系能够进行。

2. 网内通信，即通信双方都位处同一网段中，数据传输无需经过路由器(或三层交换机)，即可由本网段自主完成。假设发送主机的ARP表中并无目的主机对应的表项，则发送主机会以目的主机IP地址为内容，广播ARP请求以期获知目的主机MAC地址，并通过交换机(除到达端口之外的所有端口发送，即洪泛(Flooding))向全网段主机转发，而只有目的主机接收到此ARP请求后会将自己的MAC地址和IP地址装入ARP应答后将其回复给发送主机，发送主机接收到此ARP应答后，从中提取目的主机的MAC地址，并在其ARP表中建立目的主机的对应表项(IP地址到MAC地址的映射)，之后即可向目的主机发送数据，将待发送数据封装成帧，并通过二层设备(如交换机)转发至本网段内的目的主机，自此完成通信。

#### 26、**简述** **TCP** **协议的延迟** **ACK** **和累计应答**

1. 延迟应答指的是：TCP在接收到对端的报文后，并不会立即发送ack，而是等待一段时间发送ack，以便将ack和要发送的数据一块发送。当然ack不能无限延长，否则对端会认为包超时而造成报文重传。linux采用动态调节算法来确定延时的时间。

2. 累计应答指的是：为了保证**顺序性**，每一个包都有一个**ID**（序号），在建立连接的时候，会商定起始的ID是多少，然后按照ID一个个发送。而为了保证不丢包，对应发送的包都要进行应答，但不是一个个应答，而是会**应答某个之前的ID**，该模式称为累计应答

#### 二、**路由**

1、**简述静态路由和动态路由**

1. 静态路由是由系统管理员设计与构建的路由表规定的路由。适用于网关数量有限的场合，且网络拓朴结构不经常变化的网络。其缺点是不能动态地适用网络状况的变化，当网络状况变化后必须由网络管理员修改路由表。

2. 动态路由是由路由选择协议而动态构建的，路由协议之间通过交换各自所拥有的路由信息实时更新路由表的内容。动态路由可以自动学习网络的拓朴结构，并更新路由表。其缺点是路由广播更新信息将占据大量的网络带宽。

2、**简述网关的作用是什么，同一网段的主机如何通信**

1. 网关即网络中的关卡，我们的互联网是一个一个的局域网、城域网、等连接起来的，在连接点上就是一个一个网络的关卡，即我们的网关，他是保证网络互连的，翻译和转换，使得不同的网络体系能够进行。

2. 网内通信，即通信双方都位处同一网段中，数据传输无需经过路由器(或三层交换机)，即可由本网段自主完成。假设发送主机的ARP表中并无目的主机对应的表项，则发送主机会以目的主机IP地址为内容，广播ARP请求以期获知目的主机MAC地址，并通过交换机(除到达端口之外的所有端口发送，即洪泛(Flooding))向全网段主机转发，而只有目的主机接收到此ARP请求后会将自己的MAC地址和IP地址装入ARP应答后将其回复给发送主机，发送主机接收到此ARP应答后，从中提取目的主机的MAC地址，并在其ARP表中建立目的主机的对应表项(IP地址到MAC地址的映射)，之后即可向目的主机发送数据，将待发送数据封装成帧，并通过二层设备(如交换机)转发至本网段内的目的主机，自此完成通信。

#### 3、**简述CSRF攻击的思想以及解决方法**

1. CSRF全称叫做，跨站请求伪造。就是黑客可以伪造用户的身份去做一些操作，进而满足自身目的。要完成一次CSRF攻击，受害者必须依次完成两个步骤：
   * 1）登录受信任网站A，并在本地生成Cookie。 
   * 2）在不登出A的情况下，访问危险网站B。

此时，黑客就可以获取你的cookie达成不可告人的目的了。

2. CSRF 攻击是一种请求伪造的攻击方式，它利用的是服务器不能识别用户的类型从而盗取用户的信息来攻击。因此要防御该种攻击，因为从服务器端着手，增强服务器的识别能力，设计良好的防御机制。主要有以下几种方式：

   * 1）请求头中的Referer验证（不推荐）
     *  HTTP的头部有一个 Referer 信息的字段，它记录着该次HTTP请求的来源地址（即它从哪里来的）,既然CSRF攻击是伪造请求是从服务器发送过来的，那么我们就禁止跨域访问，在服务器端增加验证，过滤掉那些不是从本服务器发出的请求，这样可以在一定程度上避免CSRF攻击。 但是这也有缺点，比如如果是从搜索引擎所搜结果调整过来，请求也会被认为是跨域请求。

   * 2）请求令牌验证（token验证）
     *  token验证是一种比较广泛使用的防止 CSRF攻击 的手段，当用户通过正常渠道访问服务器时，服务器会生成一个随机的字符串保存在session中，并作为令牌（token）返回给客户端，以隐藏的形式保存在客户端中，客户端每次请求都会带着这个token，服务器根据该token判断该请求是否合法

 



 
